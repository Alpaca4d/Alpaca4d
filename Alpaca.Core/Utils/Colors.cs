using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.ComponentModel;
using System.Text.RegularExpressions;

using System.Drawing;
using Rhino.Geometry;
using Grasshopper;
using Grasshopper.Kernel.Data;
using Grasshopper.Kernel;

namespace Alpaca4d
{
    public partial class Colors
    {

        public static byte interpolate(byte a, byte b, double p)
        {
            return (byte)(a * (1 - p) + b * p);
        }

        public static Color GetColor(double v, SortedDictionary<double, Color> d)
        {
            KeyValuePair<double, Color> kvp_previous = new KeyValuePair<double, Color>(-1, d.Values.First());
            foreach (KeyValuePair<double, Color> kvp in d)
            {
                if (kvp.Key > v)
                {
                    double p = (v - kvp_previous.Key) / (double)(kvp.Key - kvp_previous.Key);
                    Color a = kvp_previous.Value;
                    Color b = kvp.Value;
                    Color c = Color.FromArgb(
                        interpolate(a.R, b.R, p),
                        interpolate(a.G, b.G, p),
                        interpolate(a.B, b.B, p));
                    return c;
                }
                else if (kvp.Key == v)
                {
                    return kvp.Value;
                }
                kvp_previous = kvp;
            }

            return d.Values.Last();
        }

        //public static List<System.Drawing.Color> Gradient(int index)
        //{
        //    {
        //        List<Color> colors;
        //        var keyValuePairs = new Dictionary<int, List<System.Drawing.Color>>();
        //        keyValuePairs.Add(0, new List<Color> { System.Drawing.Color.FromArgb(75, 107, 169), System.Drawing.Color.FromArgb(115, 147, 202), System.Drawing.Color.FromArgb(170, 200, 247), System.Drawing.Color.FromArgb(193, 213, 208), System.Drawing.Color.FromArgb(245, 239, 103), System.Drawing.Color.FromArgb(252, 230, 74), System.Drawing.Color.FromArgb(239, 156, 21), System.Drawing.Color.FromArgb(234, 123, 0), System.Drawing.Color.FromArgb(234, 74, 0), System.Drawing.Color.FromArgb(234, 38, 0) });
        //        keyValuePairs.Add(1, new List<Color> { System.Drawing.Color.FromArgb(49, 54, 149), System.Drawing.Color.FromArgb(69, 117, 180), System.Drawing.Color.FromArgb(116, 173, 209), System.Drawing.Color.FromArgb(171, 217, 233), System.Drawing.Color.FromArgb(224, 243, 248), System.Drawing.Color.FromArgb(255, 255, 191), System.Drawing.Color.FromArgb(254, 224, 144), System.Drawing.Color.FromArgb(253, 174, 97), System.Drawing.Color.FromArgb(244, 109, 67), System.Drawing.Color.FromArgb(215, 48, 39), System.Drawing.Color.FromArgb(165, 0, 38) });
        //        keyValuePairs.Add(2, new List<Color> { System.Drawing.Color.FromArgb(4, 25, 145), System.Drawing.Color.FromArgb(7, 48, 224), System.Drawing.Color.FromArgb(7, 88, 255), System.Drawing.Color.FromArgb(1, 232, 255), System.Drawing.Color.FromArgb(97, 246, 156), System.Drawing.Color.FromArgb(166, 249, 86), System.Drawing.Color.FromArgb(254, 244, 1), System.Drawing.Color.FromArgb(255, 121, 0), System.Drawing.Color.FromArgb(239, 39, 0), System.Drawing.Color.FromArgb(138, 17, 0) });
        //        keyValuePairs.Add(3, new List<Color> { System.Drawing.Color.FromArgb(0, 0, 255), System.Drawing.Color.FromArgb(53, 0, 202), System.Drawing.Color.FromArgb(107, 0, 148), System.Drawing.Color.FromArgb(160, 0, 95), System.Drawing.Color.FromArgb(214, 0, 41), System.Drawing.Color.FromArgb(255, 12, 0), System.Drawing.Color.FromArgb(255, 66, 0), System.Drawing.Color.FromArgb(255, 119, 0), System.Drawing.Color.FromArgb(255, 173, 0), System.Drawing.Color.FromArgb(255, 226, 0), System.Drawing.Color.FromArgb(255, 255, 0) });
        //        keyValuePairs.Add(4, new List<Color> { System.Drawing.Color.FromArgb(0, 0, 0), System.Drawing.Color.FromArgb(110, 0, 153), System.Drawing.Color.FromArgb(255, 0, 0), System.Drawing.Color.FromArgb(255, 255, 102), System.Drawing.Color.FromArgb(255, 255, 255) });
        //        keyValuePairs.Add(5, new List<Color> { System.Drawing.Color.FromArgb(0, 136, 255), System.Drawing.Color.FromArgb(200, 225, 255), System.Drawing.Color.FromArgb(255, 255, 255), System.Drawing.Color.FromArgb(255, 230, 230), System.Drawing.Color.FromArgb(255, 0, 0) });
        //        keyValuePairs.Add(6, new List<Color> { System.Drawing.Color.FromArgb(5, 48, 97), System.Drawing.Color.FromArgb(33, 102, 172), System.Drawing.Color.FromArgb(67, 147, 195), System.Drawing.Color.FromArgb(146, 197, 222), System.Drawing.Color.FromArgb(209, 229, 240), System.Drawing.Color.FromArgb(255, 255, 255), System.Drawing.Color.FromArgb(253, 219, 199), System.Drawing.Color.FromArgb(244, 165, 130), System.Drawing.Color.FromArgb(214, 96, 77), System.Drawing.Color.FromArgb(178, 24, 43), System.Drawing.Color.FromArgb(103, 0, 31) });
        //        keyValuePairs.Add(7, new List<Color> { System.Drawing.Color.FromArgb(255, 255, 255), System.Drawing.Color.FromArgb(253, 219, 199), System.Drawing.Color.FromArgb(244, 165, 130), System.Drawing.Color.FromArgb(214, 96, 77), System.Drawing.Color.FromArgb(178, 24, 43), System.Drawing.Color.FromArgb(103, 0, 31) });
        //        keyValuePairs.Add(8, new List<Color> { System.Drawing.Color.FromArgb(255, 255, 255), System.Drawing.Color.FromArgb(209, 229, 240), System.Drawing.Color.FromArgb(146, 197, 222), System.Drawing.Color.FromArgb(67, 147, 195), System.Drawing.Color.FromArgb(33, 102, 172), System.Drawing.Color.FromArgb(5, 48, 97) });
        //        keyValuePairs.Add(9, new List<Color> { System.Drawing.Color.FromArgb(0, 16, 120), System.Drawing.Color.FromArgb(38, 70, 160), System.Drawing.Color.FromArgb(5, 180, 222), System.Drawing.Color.FromArgb(16, 180, 109), System.Drawing.Color.FromArgb(59, 183, 35), System.Drawing.Color.FromArgb(143, 209, 19), System.Drawing.Color.FromArgb(228, 215, 29), System.Drawing.Color.FromArgb(246, 147, 17), System.Drawing.Color.FromArgb(243, 74, 0), System.Drawing.Color.FromArgb(255, 0, 0) });
        //        keyValuePairs.Add(10, new List<Color> { System.Drawing.Color.FromArgb(0, 191, 48), System.Drawing.Color.FromArgb(255, 238, 184), System.Drawing.Color.FromArgb(255, 0, 0) });
        //        keyValuePairs.Add(11, new List<Color> { System.Drawing.Color.FromArgb(204, 0, 71), System.Drawing.Color.FromArgb(255, 182, 71), System.Drawing.Color.FromArgb(206, 255, 115), System.Drawing.Color.FromArgb(26, 180, 214), System.Drawing.Color.FromArgb(0, 0, 207) });
        //        keyValuePairs.Add(12, new List<Color> { System.Drawing.Color.FromArgb(255, 51, 51), System.Drawing.Color.FromArgb(255, 170, 51), System.Drawing.Color.FromArgb(255, 255, 51), System.Drawing.Color.FromArgb(170, 255, 125), System.Drawing.Color.FromArgb(51, 255, 231), System.Drawing.Color.FromArgb(51, 170, 255), System.Drawing.Color.FromArgb(51, 51, 255) });
        //        bool success = keyValuePairs.TryGetValue(index, out colors);
        //        if (!success)
        //        {
        //            keyValuePairs.TryGetValue(9, out colors);
        //        }
        //        return colors;
        //    }
        //}

        public static List<Color> Gradient(int index, int step = 10)
        {
            Dictionary<int, int[]> gradientDictionary = new Dictionary<int, int[]>
            {
                {0, new[] {48,18,59,51,25,77,54,33,95,57,40,112,59,48,128,61,55,143,63,62,157,65,69,171,66,76,183,67,83,194,68,90,205,69,97,214,70,103,222,70,110,230,70,116,237,70,123,242,70,129,247,69,136,251,67,142,253,65,148,254,62,155,254,58,161,252,54,168,249,49,174,245,45,180,241,40,186,235,36,192,230,32,198,223,29,204,217,26,209,210,24,214,203,23,219,196,23,223,190,25,227,184,28,230,178,32,234,171,38,237,164,45,240,156,52,242,148,61,245,140,70,247,131,79,249,123,89,251,114,99,252,105,109,253,97,119,254,89,129,254,82,138,254,75,147,254,69,155,253,64,162,252,60,169,251,56,176,249,54,182,246,53,189,244,52,195,240,51,202,237,51,208,233,52,214,229,53,219,225,54,225,220,55,230,215,56,234,210,57,238,205,57,242,200,58,245,195,58,248,189,57,250,184,55,252,178,54,253,172,51,253,165,49,254,158,46,254,150,43,253,143,40,252,135,37,251,127,33,249,120,30,247,112,27,245,105,23,242,97,20,239,90,17,236,83,15,233,77,13,229,71,11,225,66,9,221,61,7,217,55,6,212,51,5,207,46,4,201,41,3,196,37,2,190,33,2,183,29,1,177,25,1,170,21,1,163,18,1,155,15,1,147,12,1,139,9,1,131,6,2,122,4,2} }, // turbo
                {1, new[] {68,1,84,69,4,87,69,8,91,70,12,95,71,16,98,71,19,102,71,23,105,72,26,108,72,30,111,72,33,114,72,36,117,71,39,119,71,43,122,70,46,124,70,49,126,69,52,128,68,55,129,67,58,131,66,61,132,65,64,134,64,67,135,63,70,136,62,73,137,61,76,137,59,79,138,58,81,139,57,84,139,56,87,140,54,90,140,53,92,140,52,95,141,51,97,141,50,100,141,48,102,141,47,105,141,46,107,142,45,110,142,44,112,142,43,115,142,42,117,142,41,120,142,40,122,142,39,124,142,38,127,142,37,129,142,37,132,141,36,134,141,35,136,141,34,139,141,33,141,140,32,144,140,31,146,140,31,148,139,30,151,138,30,153,138,30,156,137,30,158,136,31,160,135,31,163,134,32,165,133,34,167,132,36,170,130,38,172,129,40,174,127,43,177,125,47,179,123,50,181,121,54,184,119,58,186,117,62,188,115,67,190,112,71,192,110,76,194,107,81,196,104,87,198,101,92,200,98,98,202,95,103,204,91,109,206,88,115,207,84,121,209,81,127,211,77,134,212,73,140,214,69,147,215,65,153,216,60,160,218,56,167,219,52,174,220,47,180,221,43,187,222,38,194,223,34,201,224,31,208,225,27,214,226,25,221,226,24,228,227,24,234,228,25,240,229,28,247,230,32,253,231,36} }, // viridis
                {2, new[] {12,7,134,20,6,137,27,6,140,33,5,143,38,5,145,43,5,147,48,4,149,52,4,151,57,4,153,61,3,155,65,3,157,70,3,158,74,2,160,78,2,161,82,1,162,86,1,164,90,0,165,94,0,166,98,0,166,102,0,167,106,0,167,110,0,168,114,0,168,118,1,168,122,1,168,125,2,167,129,4,167,133,6,166,136,8,165,140,10,164,144,13,163,147,16,161,151,19,160,154,22,158,157,24,156,161,27,154,164,30,152,167,33,150,170,36,148,173,39,146,176,42,143,179,44,141,182,47,139,185,50,136,187,53,134,190,56,132,193,59,129,195,62,127,198,65,124,200,68,122,203,70,120,205,73,117,207,76,115,210,79,113,212,82,111,214,85,108,216,88,106,218,91,104,220,94,102,222,97,99,224,100,97,226,103,95,228,106,93,230,109,91,232,112,88,233,115,86,235,118,84,237,121,82,238,124,80,240,128,78,241,131,75,243,134,73,244,138,71,245,141,69,246,144,66,247,148,64,248,151,62,249,155,60,250,159,58,251,162,56,252,166,53,252,170,51,252,173,49,253,177,47,253,181,45,253,185,43,253,189,42,253,193,40,253,197,39,252,201,38,252,205,37,251,209,36,250,213,36,249,218,36,248,222,36,247,226,37,245,231,38,244,235,38,242,239,38,241,244,37,239,248,33} }, // plasma
                {3, new[] {0,0,3,1,0,7,2,1,12,3,2,17,5,3,23,7,5,28,9,6,34,12,8,40,16,9,46,19,10,52,23,11,58,26,11,64,30,12,70,34,11,76,39,11,82,43,10,87,48,10,91,52,9,95,57,9,98,61,9,101,65,9,103,70,10,105,74,11,106,78,12,107,82,14,108,86,15,109,90,17,109,94,18,110,98,20,110,102,21,110,106,23,110,111,24,110,115,26,109,119,27,109,123,29,108,127,30,108,131,32,107,135,33,106,139,34,105,143,36,104,147,37,103,151,39,101,155,40,100,159,42,98,163,43,97,167,45,95,171,47,93,175,48,91,179,50,89,183,52,86,186,54,84,190,56,82,194,58,79,197,61,77,201,63,74,204,66,71,208,68,69,211,71,66,214,74,63,217,77,60,220,80,57,223,84,54,226,87,51,228,91,48,231,94,45,233,98,42,235,102,39,237,106,35,239,110,32,241,114,29,243,118,26,244,122,22,245,127,19,247,131,15,248,136,12,249,140,9,250,145,7,250,150,6,251,154,6,251,159,7,251,164,10,251,169,14,251,174,18,251,179,23,251,184,29,250,189,34,250,194,40,249,199,47,248,204,53,247,209,60,246,214,68,244,219,76,243,224,84,242,228,93,241,233,103,241,237,113,241,241,124,242,245,135,245,248,145,248,251,155,252,254,164} }, // inferno
                {4, new[] {0,0,3,1,0,6,1,1,11,3,2,16,4,4,21,6,5,27,9,7,32,12,9,38,14,11,43,17,12,49,20,14,55,23,15,61,26,16,67,30,16,73,34,17,79,37,17,85,41,17,91,46,16,97,50,16,102,54,15,107,59,15,111,63,15,115,67,15,117,72,16,120,76,16,122,80,18,123,84,19,124,88,21,125,92,22,126,96,24,127,100,25,128,104,27,128,108,29,128,112,30,129,116,32,129,120,33,129,124,35,129,128,36,129,132,38,129,136,39,129,140,41,128,144,42,128,148,43,128,152,45,127,156,46,127,160,47,126,165,49,125,169,50,124,173,51,123,177,53,122,181,54,121,186,55,120,190,57,118,194,59,117,198,60,115,202,62,113,206,64,112,210,66,110,214,68,108,217,70,106,221,73,104,224,76,102,228,79,100,231,82,98,234,85,96,236,89,95,239,93,93,241,97,92,243,102,92,245,106,91,246,111,91,247,115,92,248,120,92,249,125,93,250,130,95,251,135,96,252,139,98,252,144,101,252,149,103,253,154,106,253,159,108,253,163,112,254,168,115,254,173,118,254,178,121,254,182,125,254,187,129,254,192,133,254,196,137,254,201,141,253,206,145,253,210,149,253,215,153,253,220,158,253,224,162,252,229,167,252,234,171,252,238,176,252,243,181,251,248,186,251,252,191} }, // magma
                {5, new[] {0,255,255,2,252,255,5,249,255,7,247,255,10,244,255,12,242,255,15,239,255,17,237,255,20,234,255,22,232,255,25,229,255,28,226,255,30,224,255,33,221,255,35,219,255,38,216,255,40,214,255,43,211,255,45,209,255,48,206,255,51,204,255,53,201,255,56,198,255,58,196,255,61,193,255,63,191,255,66,188,255,68,186,255,71,183,255,73,181,255,76,178,255,79,175,255,81,173,255,84,170,255,86,168,255,89,165,255,91,163,255,94,160,255,96,158,255,99,155,255,102,153,255,104,150,255,107,147,255,109,145,255,112,142,255,114,140,255,117,137,255,119,135,255,122,132,255,124,130,255,127,127,255,130,124,255,132,122,255,135,119,255,137,117,255,140,114,255,142,112,255,145,109,255,147,107,255,150,104,255,153,102,255,155,99,255,158,96,255,160,94,255,163,91,255,165,89,255,168,86,255,170,84,255,173,81,255,175,79,255,178,76,255,181,73,255,183,71,255,186,68,255,188,66,255,191,63,255,193,61,255,196,58,255,198,56,255,201,53,255,204,51,255,206,48,255,209,45,255,211,43,255,214,40,255,216,38,255,219,35,255,221,33,255,224,30,255,226,28,255,229,25,255,232,22,255,234,20,255,237,17,255,239,15,255,242,12,255,244,10,255,247,7,255,249,5,255,252,2,255,255,0,255} }, // cool
                {6, new[] {10,0,0,17,0,0,23,0,0,30,0,0,37,0,0,44,0,0,50,0,0,57,0,0,64,0,0,70,0,0,77,0,0,84,0,0,90,0,0,97,0,0,104,0,0,111,0,0,117,0,0,124,0,0,131,0,0,137,0,0,144,0,0,151,0,0,157,0,0,164,0,0,171,0,0,177,0,0,184,0,0,191,0,0,198,0,0,204,0,0,211,0,0,218,0,0,224,0,0,231,0,0,238,0,0,244,0,0,251,0,0,255,3,0,255,9,0,255,16,0,255,23,0,255,30,0,255,36,0,255,43,0,255,50,0,255,56,0,255,63,0,255,70,0,255,76,0,255,83,0,255,90,0,255,97,0,255,103,0,255,110,0,255,117,0,255,123,0,255,130,0,255,137,0,255,143,0,255,150,0,255,157,0,255,163,0,255,170,0,255,177,0,255,184,0,255,190,0,255,197,0,255,204,0,255,210,0,255,217,0,255,224,0,255,230,0,255,237,0,255,244,0,255,250,0,255,255,3,255,255,14,255,255,24,255,255,34,255,255,44,255,255,54,255,255,64,255,255,74,255,255,84,255,255,94,255,255,104,255,255,114,255,255,124,255,255,134,255,255,144,255,255,154,255,255,164,255,255,174,255,255,184,255,255,194,255,255,204,255,255,214,255,255,224,255,255,234,255,255,244,255,255,255} }, // hot
                {7, new[] {58,76,192,61,80,196,64,85,199,67,89,203,70,93,207,73,98,211,76,102,214,79,106,217,83,111,221,86,115,224,89,119,227,92,123,229,96,127,232,99,131,235,102,135,237,106,139,239,109,143,241,112,147,243,116,151,245,119,155,247,123,158,248,126,162,249,130,165,251,133,169,252,137,172,252,141,175,253,144,178,254,148,181,254,151,184,254,155,187,254,158,190,254,162,193,254,165,195,254,169,197,253,172,200,252,175,202,251,179,204,250,182,206,249,185,208,248,188,210,246,192,211,245,195,213,243,198,214,241,201,215,239,204,216,236,207,217,234,210,218,231,212,219,229,215,219,226,218,220,223,220,220,220,223,219,217,225,217,213,228,216,209,230,214,206,232,213,202,235,211,198,236,209,194,238,207,190,240,205,186,241,202,182,242,200,178,243,197,174,244,194,170,245,191,166,246,189,162,246,185,158,246,182,154,247,179,150,247,176,146,247,172,142,246,168,138,246,165,134,245,161,130,245,157,126,244,153,122,243,149,118,241,145,115,240,141,111,239,136,107,237,132,103,236,127,99,234,123,96,232,118,92,230,113,88,227,108,85,225,103,81,222,98,78,220,93,74,217,88,71,214,83,68,211,77,64,208,71,61,205,65,58,202,59,55,198,52,52,194,46,49,191,38,46,187,27,43,183,15,41,179,3,38} }, // coolwarm
                {8, new[] {158,0,65,163,7,67,169,13,68,174,19,69,179,25,71,185,31,72,190,37,73,196,43,75,201,49,76,207,55,77,212,61,78,216,66,77,219,71,76,222,76,75,225,80,74,228,85,73,231,90,71,234,94,70,237,99,69,240,104,68,243,108,67,244,115,70,245,121,72,246,128,75,247,134,78,248,141,81,249,147,84,250,154,88,251,160,91,252,167,94,252,173,97,253,179,101,253,183,105,253,188,109,253,193,113,253,199,117,253,204,122,253,209,126,253,213,130,253,218,134,254,223,139,254,227,144,254,230,149,254,233,154,254,236,159,254,239,165,254,242,170,254,245,175,254,248,180,254,251,185,254,254,190,252,254,187,249,252,183,247,252,179,245,250,175,242,250,171,240,248,167,237,248,163,234,246,159,232,246,155,229,244,152,224,242,153,218,240,154,212,237,155,206,235,156,200,232,157,194,230,159,188,228,160,182,225,161,176,223,162,170,220,163,164,218,164,157,215,164,150,212,164,143,210,164,136,207,164,129,204,164,122,202,164,115,199,164,108,196,164,102,193,165,96,188,167,91,182,169,86,176,172,81,170,174,76,165,176,70,159,179,65,153,181,60,147,184,55,141,186,50,136,188,54,130,186,58,124,183,63,118,180,67,113,178,71,107,175,76,101,172,80,96,170,85,90,167,89,84,164,94,78,161} }, // spectral
                {9, new[] {0,0,76,0,0,83,0,0,90,0,0,97,0,0,105,0,0,112,0,0,119,0,0,126,0,0,133,0,0,140,0,0,147,0,0,155,0,0,162,0,0,169,0,0,176,0,0,183,0,0,190,0,0,197,0,0,205,0,0,212,0,0,219,0,0,226,0,0,233,0,0,240,0,0,247,0,0,254,10,10,255,20,20,255,30,30,255,40,40,255,51,51,255,61,61,255,71,71,255,81,81,255,91,91,255,102,102,255,112,112,255,122,122,255,132,132,255,142,142,255,153,153,255,163,163,255,173,173,255,183,183,255,193,193,255,204,204,255,214,214,255,224,224,255,234,234,255,244,244,255,254,253,254,255,244,244,255,234,234,255,224,224,255,214,214,255,204,204,255,193,193,255,183,183,255,173,173,255,163,163,255,153,153,255,142,142,255,132,132,255,122,122,255,112,112,255,102,102,255,91,91,255,81,81,255,71,71,255,61,61,255,51,51,255,40,40,255,30,30,255,20,20,255,10,10,254,0,0,249,0,0,244,0,0,239,0,0,234,0,0,229,0,0,224,0,0,219,0,0,214,0,0,209,0,0,204,0,0,198,0,0,193,0,0,188,0,0,183,0,0,178,0,0,173,0,0,168,0,0,163,0,0,158,0,0,153,0,0,147,0,0,142,0,0,137,0,0,132,0,0,127,0,0} }, // seismic
                {10, new[] {1,25,89,3,29,89,5,33,90,7,36,91,9,40,91,11,44,92,12,47,93,13,51,93,14,54,94,14,57,94,15,60,95,16,63,95,16,65,96,17,68,96,18,70,96,18,73,97,19,75,97,20,77,97,21,80,97,22,82,98,24,84,98,25,87,98,27,89,98,29,91,97,31,93,97,33,95,96,36,97,96,39,99,95,42,101,94,45,102,92,48,104,91,52,105,89,55,107,88,59,108,86,62,110,84,66,111,82,70,112,80,74,114,77,78,115,75,82,116,73,86,117,71,90,118,69,94,120,66,98,121,64,103,122,62,107,123,60,111,125,57,115,126,55,120,127,53,124,128,51,129,130,49,134,131,47,138,132,46,143,133,45,148,134,44,153,136,43,158,137,43,163,138,43,168,139,44,173,140,45,178,141,47,183,142,49,188,143,51,193,144,54,198,145,57,202,145,61,207,146,64,211,147,68,216,148,72,220,149,76,224,150,81,228,151,86,232,152,91,235,153,96,238,155,101,241,156,107,244,158,113,246,160,119,248,161,125,249,163,131,250,165,137,251,167,143,252,169,149,252,171,154,253,173,160,253,175,166,253,177,171,253,178,177,253,180,182,253,182,187,252,184,193,252,186,198,252,188,204,252,190,209,252,192,215,251,193,220,251,195,226,251,197,232,251,199,238,250,202,244,250,204,250} }, // batlow
                {11, new[] {26,14,51,30,15,53,34,17,55,38,18,57,41,19,60,45,21,62,49,22,64,53,24,66,57,25,69,61,27,71,65,29,73,68,31,76,72,33,78,76,35,80,80,38,83,84,40,85,88,43,88,92,46,90,95,49,93,99,51,95,102,54,97,106,57,99,109,60,102,112,64,104,115,67,106,117,70,108,120,73,109,122,76,111,124,79,113,126,82,114,127,84,116,129,87,117,130,90,118,132,93,119,133,95,120,134,98,122,135,101,123,136,103,123,137,106,124,137,108,125,138,111,126,139,113,127,139,115,128,140,118,128,140,120,129,141,122,130,141,125,131,142,127,131,142,129,132,143,132,133,143,134,133,143,136,134,144,139,135,144,141,135,145,143,136,145,146,137,145,148,137,146,150,138,146,153,138,147,155,139,147,157,140,147,160,140,148,162,141,148,165,142,149,167,142,150,170,143,150,172,144,151,175,144,152,177,145,152,180,146,153,182,147,154,185,148,156,188,149,157,191,150,159,194,151,160,197,152,162,200,154,165,203,156,167,206,157,170,210,159,174,213,162,177,217,164,181,220,167,185,224,169,190,227,172,194,230,175,199,233,178,204,236,181,208,239,184,213,241,187,217,243,190,221,245,193,226,247,196,230,248,199,233,249,201,237,250,204,241,251,207,244,252,209,247,253,211,251,253,214,254,254,216} }, // tokyo
                {12, new[] {178,0,178,178,6,176,178,11,174,178,16,172,178,20,170,178,24,168,178,27,166,178,30,164,178,33,162,178,36,161,178,39,159,178,42,158,179,45,156,179,48,155,179,50,154,180,53,153,180,55,151,181,58,150,182,61,150,182,63,149,183,66,148,184,68,147,185,70,146,185,73,145,186,75,144,187,78,144,188,80,143,189,82,142,189,84,141,190,87,141,191,89,140,192,91,139,192,93,138,193,96,138,194,98,137,195,100,136,195,102,135,196,104,135,197,106,134,197,109,133,198,111,132,199,113,132,200,115,131,200,117,130,201,119,130,202,122,129,202,124,128,203,126,128,204,128,127,204,130,126,205,132,126,205,135,125,206,137,125,207,139,124,207,141,124,208,143,123,208,146,122,209,148,122,209,150,121,210,152,121,210,154,120,211,157,120,212,159,119,212,161,119,213,163,118,213,166,117,214,168,117,214,170,116,215,172,116,215,175,115,216,177,115,217,179,114,217,182,113,218,184,113,218,186,112,219,188,112,219,191,111,220,193,111,221,195,110,221,198,109,222,200,109,222,202,108,223,205,108,224,207,107,224,210,106,225,212,106,226,214,105,226,217,105,227,220,104,228,222,104,230,225,103,231,227,103,233,230,103,235,233,102,237,236,102,240,239,102,243,242,102,245,245,102,248,248,102,251,251,102,255,255,102} }, // buda
                {13, new[] {25,51,178,27,52,177,28,54,176,29,56,175,30,58,174,30,60,174,31,61,173,32,63,172,33,65,171,34,66,170,35,68,169,36,70,168,36,72,168,37,73,167,38,75,166,39,77,165,40,78,164,41,80,163,41,82,162,42,83,162,43,85,161,44,87,160,45,88,159,46,90,158,47,92,157,47,93,156,48,95,155,49,96,154,50,98,153,52,100,152,53,101,151,54,103,150,55,104,149,56,106,148,58,107,146,59,109,145,60,110,144,62,112,142,63,113,141,64,114,140,66,116,138,67,117,137,69,119,136,70,121,134,72,122,133,74,124,132,75,126,131,77,127,129,79,129,128,81,131,127,83,133,127,85,135,126,87,138,125,89,140,124,92,142,124,94,144,123,96,147,122,99,149,122,101,152,121,103,154,120,106,156,120,108,159,119,111,161,119,113,164,118,116,166,117,118,169,117,121,171,116,123,174,115,126,177,115,128,179,114,131,182,113,134,184,113,136,187,112,139,190,112,142,192,111,144,195,110,147,198,110,150,201,109,153,203,108,156,206,107,159,209,107,162,212,106,165,215,106,169,217,105,173,220,104,177,223,104,181,226,103,186,228,103,191,231,103,196,233,102,201,235,102,206,238,102,212,240,102,217,242,102,222,244,102,228,245,102,233,247,102,238,249,102,244,251,102,249,253,102,255,254,102} }, // imola
                {14, new[] {0,17,96,0,22,99,1,26,101,1,30,104,2,34,107,2,38,109,2,42,112,2,45,114,2,49,117,2,53,119,2,57,122,2,61,124,2,65,127,2,69,129,3,73,132,3,77,135,4,82,137,6,86,140,9,90,143,12,95,146,17,99,149,22,104,152,27,109,155,33,114,159,40,119,162,47,124,166,54,129,169,62,134,173,69,140,176,77,145,180,85,150,183,93,155,187,101,161,190,109,166,194,117,171,197,126,176,201,134,181,204,142,186,208,150,191,211,158,196,215,166,201,218,174,206,221,182,210,224,190,215,227,198,219,230,206,223,232,214,227,233,221,229,233,227,230,232,232,230,229,235,229,225,237,226,220,238,222,214,238,218,207,236,213,200,235,208,193,233,203,186,231,198,180,229,193,173,227,188,166,225,183,159,222,178,152,220,173,146,218,168,139,216,163,133,214,159,126,212,154,120,210,149,114,208,145,108,206,140,102,204,135,96,202,131,90,200,126,84,198,122,78,197,117,72,195,113,66,193,109,60,190,104,55,188,99,49,186,94,43,183,89,37,179,84,32,176,78,26,171,72,20,166,66,15,161,60,11,155,54,8,150,48,6,144,43,5,139,39,5,134,35,5,129,31,5,124,27,5,119,24,6,115,20,6,110,16,6,106,13,6,101,9,7,97,5,7,93,2,7,89,0,7} }, // vik
                {15, new[] {125,23,0,128,30,2,131,37,4,133,43,6,136,48,7,139,53,9,141,58,11,144,63,13,146,68,15,149,73,17,151,77,19,153,81,21,155,86,23,157,90,24,159,94,26,161,98,28,163,102,30,165,106,31,167,110,33,169,114,35,171,118,37,173,122,39,175,126,41,177,131,44,179,135,46,181,139,49,184,144,52,186,149,55,188,153,59,190,158,63,192,163,67,195,168,72,197,173,77,199,178,83,201,183,89,203,188,95,205,193,102,207,198,109,208,203,116,209,207,124,210,212,132,210,216,139,210,219,147,209,223,154,208,225,161,207,228,167,205,230,174,202,231,179,199,233,185,196,233,190,192,234,194,188,234,198,183,233,201,179,233,204,173,232,207,168,230,209,162,228,211,156,226,212,149,224,214,143,221,214,136,218,215,129,215,215,123,211,215,116,207,214,109,203,213,103,199,213,97,195,212,91,191,210,85,187,209,80,182,208,75,178,206,71,174,205,67,169,203,63,165,201,60,161,200,56,156,198,54,152,196,51,148,195,49,144,193,47,140,191,45,136,189,43,132,188,41,128,186,40,124,184,38,120,183,37,116,181,36,112,179,34,108,177,33,104,176,32,99,174,30,95,172,29,91,170,27,86,168,25,82,166,23,77,164,21,73,162,19,68,160,16,63,158,12,58,156,7,54,154,2,48,152} }, // roma
                {16, new[] {101,2,75,106,8,81,112,15,86,118,21,92,123,27,97,128,32,103,134,37,108,139,41,113,144,46,118,149,51,123,153,55,128,158,59,132,163,64,137,167,68,141,171,72,146,175,77,150,179,81,154,182,85,157,186,90,161,189,94,165,193,99,169,196,104,172,199,109,176,202,115,180,205,120,183,208,126,187,211,131,190,213,137,194,216,143,197,218,148,200,221,154,203,223,160,207,225,166,210,227,172,213,229,177,216,231,183,218,233,189,221,235,194,224,236,199,227,238,204,229,239,209,231,241,213,233,242,218,235,243,222,237,244,226,238,245,229,239,245,232,240,246,235,241,246,237,241,246,239,241,245,240,240,245,241,239,244,242,238,243,243,236,241,243,234,240,242,231,237,242,227,235,241,223,232,240,219,229,238,214,225,237,208,221,235,202,217,232,196,213,230,189,208,227,182,202,223,174,197,220,167,191,216,159,184,212,151,178,208,143,172,203,135,165,199,127,159,194,120,152,189,113,146,185,106,140,180,100,134,175,94,128,171,89,122,166,84,116,162,79,111,158,75,106,153,70,101,149,66,96,145,62,91,141,59,87,137,55,82,134,52,78,130,48,73,126,45,69,122,42,64,118,38,60,114,35,55,110,31,51,106,28,46,102,24,41,98,20,36,93,16,31,89,12,25,84,7,19,80,3,12,75,0} }, // bam
                {17, new[] {158,175,254,152,175,252,146,174,249,140,174,246,134,173,243,128,172,240,122,171,237,116,170,234,109,169,231,103,167,227,97,165,223,90,163,218,84,160,213,78,157,208,73,154,203,68,150,197,63,146,190,59,141,184,56,137,178,53,132,171,50,127,165,48,123,159,45,118,152,43,113,146,42,108,140,40,104,134,38,99,128,36,94,122,34,90,116,33,85,110,31,81,104,29,76,98,27,72,93,26,67,87,24,63,81,23,59,76,21,54,70,20,50,65,19,46,60,18,42,55,17,39,49,16,35,44,16,31,40,16,28,35,16,25,31,16,22,27,17,20,23,18,17,19,19,15,16,22,13,12,24,12,9,27,11,6,30,11,4,32,11,2,35,11,1,38,12,1,41,13,0,44,14,0,47,14,0,51,15,0,54,15,0,58,16,0,61,17,0,65,18,0,69,19,1,73,21,1,77,22,2,81,24,3,86,26,5,91,28,7,96,31,10,101,34,13,107,38,16,112,42,20,118,46,24,123,50,28,129,55,33,134,59,38,139,64,43,145,68,49,150,73,54,155,78,59,160,83,65,165,87,71,170,92,76,175,97,82,180,102,88,185,107,94,190,112,100,195,116,105,201,121,111,206,126,117,211,131,123,217,137,129,222,142,136,227,147,142,233,152,148,238,157,154,244,162,160,249,168,167,254,173,173} }, // berlin
            };

            var colors = new List<Color>();
            if (gradientDictionary.TryGetValue(index, out int[] gradient))
            {
                for (int i = 0; i <  gradient.Length; i+=3)
                {
                    colors.Add(Color.FromArgb(gradient[i], gradient[i+1], gradient[i+2]));
                }

                colors = Enumerable.Range(0, step)      // 10 elements
                    .Select(i => colors[i * 10])         // Pick index 0, 10, 20, ...
                    .ToList();

                return colors;
            }
            else
            {
                return colors;
            }
        }
    }
}
